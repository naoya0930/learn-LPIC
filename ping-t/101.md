# LDIC
# 1.1
### ハードウェア設定の決定と設定分野
- BIOSとUEFIの違い
  - BIOS...古い
    - 基本デバイスのチェックと初期化
    - OSが起動する前に実行する
  - UEFI...新しい
    - セキュアブートが可能
### デバイス情報の確認
- `/proc/cpuinfo`
  - CPU情報
- `/proc/interrupts`
  - IRQ情報
  - Interrupt Request
- `/proc/ioport`
  - i/Oアドレス
- `/proc/meminfo`
  - メモリ情報
- `/proc/bus/usb/*`
  - USBデバイス情報
- `/proc/bus/pci/*`
  - PCIデバイス情報
###　カーネルによるハードウェア検出
- カーネルブート時のログを出力させるコマンドを利用
  - `dmseg | less`で出力
    - display message コマンドのこと
### カーネルって何？
- OSの駐屯プログラム
- 起動前は物理ストレージにある
- 起動後は、常にメモリ上にある
- CPU,メモリの管理
### 仮想ファイルシステム
- OSのカーネルが提供する仮想ファイル
- 問い合わせ(書き込み、読み込み、参照)のたびにリアルタイムで生成する
 - `/proc`
  - プロセスやカーネルの状態
  - この配下にいくつかファイルとして各情報にアクセス

- `/sys`
  - ネットワークデバイス
  - 論理デバイス構造
### デバイスドライバのロード
- `lsmod`
  - デバイスと連携するために必要な制御プログラムのダウンロード
- `modprobe`
  - 手動でデバイスドライバをダウンロードする
  - モジュールプルーブ
  - モジュールとは？
    - USB,NIC,GPUなどのドライバのこと。およびそのファイル形式
    - メーカが提供するドライバもあるため、この婆愛はネットワークから取得する
  - modprobeコマンドで引っ張って来れるのは、OSなどに元々入っているものを引っ張ってくることができる。
### USBデバイス
- `lsusb`
  - 別途ライブラリが必要ƒmod
  - 階層構造で管理している部分もある
### devディレクトリ
- デバイスファイルを主に制御する
- udev（Userspace DEVice managementという仕組みによって自動的に作成されます。

# 1.2 起動、シャットダウン
### システム起動の流れ
- ブートプロセスや、ブートストラップと呼んだりする
- 1. BIOS/IEFI
- 2. ブートローダ
- 3. カーネル
- 4. init/systemd
- 

### initramfs
- イニット ラム ファイルシステム
- カーネルが起動する際に使用するファイルシステム
  - ドライバの読み込み
  - rootのマウントを実施する

###　カーネルによるハードウェア検出
- カーネルブート時のログを出力させるコマンドを利用
  - `dmseg | less`で出力
    - display message コマンドのこと
  - `journalctl`でも閲覧可能
    - こちらは、systemdの採用が必須 
    - デバイス
    - マウントポイント
    - ソケット
    - パス　などが結合されている

### シャットダウン/再起動コマンド
- shutdown
  - -h シャットダウン 時間指定
  - -r 再起動する 時間指定
  - -f fsckをスキップする
  - -k 実際にはシャットダウンしない
  - -c 現在実行中のシャットダウンをキャンセル
- halt
  - システム停止
- systemd poweroff
  - systemd経由でシャットダウン
- init 0
  - シャットダウン
  - ランレベル 0
- init 6
  - 再起動

### fsck
-  ファイルシステムの整合性を確認するコマンド
-  壊れたシステムに対して復帰を図る
   - メタデータとしてファイルを管理している

# 1.3 sysVinit
- カーネルがリソースマウント後に起動する`init`プロセスから呼び出される初期起動するプロセスのこと
- 昔のシステム。今はsystemdに置き換わっている
- [システム起動の流れ]の4から以下のように起動
  - 1. initが/etc/inittabファイルを読み込む
  - 2. initが/etc.sysinitスクリプトを読み込む
  - 3. /etc/rcスクリプトが各種`.d`スクリプトを実行
    - これはランレベルごとに異なるファイルを実行する
### ランレベル
- systemdには存在しない概念
- `runlevel`コマンドで今の状態がわかる
- ある時間のシステムに対して、一つ存在する。
- レベルによって、システムの状態を表現する
  - Red Hat系
    - 0 停止
    - 1 シングルユーザモード
    - 2,3,5 マルチユーザモード
    - 4 未使用
    - 6 再起動
    - S,s シングルユーザモード
  - Debian系
    - 0 停止
    - 1 シングルユーザモード
    - 2.3.4.5マルチユーザ
    - 6 再起動
    - s,S シングルユーザ
### シングルユーザモード
- ルートユーザのみが使用できる
- システムの修復のために利用する
### ランレベルごとのサービス起動
- ファイルに起動、終了するファイルが記載されている
- `/etc/rc3.d/`
  - ランレベル3で起動した場合の起動するファイルが記載
- 作法として、`/etc/init.d`に保存されているファイルのシンボリックリンクで記載することが多い


### inittab
- `/etc/inittab`のファイルのこと
- `init`プロセスは、ここのファイルを見て初期の起動ランタイムレベルを制御する
- `id4:initdefault:`など


# 1.4 systemd