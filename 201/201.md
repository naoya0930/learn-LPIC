# キャパシティプランニング
## キャパシティプランニング主要なコマンド
#### topの使い方
- オプション
  - -b...対話モードではなくバッチモードで実行
    - fを押してもモード変更しない
  - -d {sec}...表示を更新する秒間隔を指定
  - -n {count}...指定した回数だけ更新すると終了する
  - -u {user}...指定したユーザを監視
  - -p {PID}...指定したPIDのみを監視
    - コンマ区切りで複数指定ができる
#### top表示項目
- PID
- PPID...親のPID
- USER
- RUSER...実ユーザ名
- UID
- GROUP
- PR...実行優先度
- NI...nice値
- VIRT...使用中の仮想メモリ(KB)
  - Virtual Memory
- RES...使用中の実メモリ(KB)
  - Resident Set Size
- SHR...共有メモリサイズ(KB)
  - Shared Memory Size
- S...プロセスの状態
- TTY...制御端末名
- CPU
- MEM
- TIME+...プロセスが開始していから使用したCPU時間の総計
- COMMAND
#### top表示項目の補足

- ※ 実行優先度(PR)とnice値の違い
-  nice値
   -  -20(優先度高い) ~ ~+19(優先度が低い)
-  実行優先度(PR)
   -  20 + {nice値}
- ※ VIRT,RES,SHRの違い
- VIRT...Mallocなどで確保したメモリサイズ
- RES...RAM上に読み込まれているサイズ
- SHR...他のプロセスと共有している
  - libc,libpathreadなどが該当する
- これらから専有メモリサイズという考え方がある
  - 専有メモリ = RES - SHR
- ※ VIRTについてもう少し詳しく
  - 以下を含む領域の合算
    - 1. 使用中の物理メモリ
    - 2. 共有ライブラリ
    - 3. スタック領域
    - 4. ヒープ（Malloc）で確保した領域
  - `オーバコミット`という仕組みで物理メモリ以上の空間をヒープとして確保可能
    - 実際に使用されるタイミングで確保する
    - Javaやpythonはメモリ要求が膨大に設定されているため、これがデフォルト
#### top中の操作
- スペース、エンター
- 上側のコンピュータステータスの表示の変更
  - f...表示する項目の変更
  - o...表示項目の順番の変更
  - l...平均負荷の非表示
  - m...メモリスワップ量の値表示・ゲージ表示・非表示を切り替え
  - u...ユーザを指定する
  - t...プロセスとCPU状態を表示・ゲージ表示・非表示を切り替え
- 下側のコンピュータステータスの表示の変更（SHIFT操作が多いと覚える）
  - A...表示モード切り替え
  - P...プロセスを使用CPU順にソート
  - M...プロセスを使用メモリ順にソート
  - N...プロセスをPID順にソート
  - T...現在の設定を保存する
  - W...現在の設定を保存
  - < or >...ソートする項目を変更
- その他
  - k...プロセスにシグナルを送信（お前そんなんできんのか）
  - h or ?...ヘルプ
  - q...終了
  - d or s...更新時間の指定


#### vmstat
#### iostat
#### iotop
#### sar
#### sadf
#### uptime
#### w

## CPU使用率の測定
#### ps
#### pstree

## メモリ及びスワップの使用量の測定
#### free
## ディスク使用量の測定
#### df
## ネットワークトラフィックの測定
#### netstat
#### ss
#### Netperf
- netserver(サーバ)、
  - このコマンドでポートでリッスンする
  - 12865ポートをデフォルトで使用する
- netperf(クライアント)を使用する

# リソース需要の分析と予想
### りソース監視ツール
#### collectd
#### Nagios
#### MGTR
#### Cacti
#### Icinga2

