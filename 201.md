# DNS

### DNSの仕組み
- クライアントはまず、リゾルバに聞きに行く
- リゾルバは、DNSサーバに聞きに行く
- NSサーバは以下の順序で非再帰問い合わせする
  - ルートDNSサーバ
  - ファーストドメインサーバに問い合わせ
  - セカンドドメインサーバに問い合わせ
  - ...
- DNSサーバから結果を受け取る

### 再帰/非再帰
- クライアントからDNSサーバは、再帰的問い合わせ
  - 結果が戻ってくるまで全てを依頼する
- DNSサーバからのドメインサーバへの問い合わせは非再帰問い合わせ
  - 逐次問い合わせに行く

### DNSサーバ色々
- BIND
- dnsmasq...コンテンツサーバも持つ
- djbdns...IPv6に対応していない
- PowerDNS
### BIND
- berkeley Internet Name Domain
- 現在の最新バージョンは9
- BIND9とか呼ばれる
- namedデーモンを立ち上げる
  - /usr/sbin/namedに存在する
  - サービス名はdomain
  - UDP 53番
### BINDの設定ファイル
- `/etc/named.conf`
- ステートメント
  - acl{}
    - 
  - controls{}
  - options{}
    - named全体の基本動作を定義
    - 色々あるので後で記載
  - zone "." IN{}
    - ルートゾーン
    - ルートDNSサーバの一覧
    - `type hint;`と記載がある
  - zone "{domain}" IN{}
    - 正引きゾーン
    - このDNSが管理するドメインを指す
    - `type master;`と記載がある
    - `file "{zonefile}"`ゾーンファイル名を指定
  - zone "{IP}.in-addr.arpa" IN {}
    - 逆引きゾーン
    - これも`type master;`と記載